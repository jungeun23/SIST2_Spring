<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<!-- lecture.xml -->

<mapper namespace="lecture"> <!-- 파일명을 보편적으로 사용 -->
	
	<!-- <select id="m7" resultType="dto" parameterType="String">
		select * from tblMemo where seq=#{seq}
	
	</select>
	
	결과셋이 다중 레코드라도 1개의 레코드를 담을 수 있는 자료형만 resultType에 적는다 
	<select id="m8" resultType="dto">
		select * from tblMemo order by seq desc
	</select> -->
	
	<select id="getAll" parameterType="String" resultType="lcldto">
		select * from vwClassList where categoryBig = #{category} order by classSeq asc
	</select>
	<select id="csmallList" parameterType="lcldto" resultType="lcldto">
		select * from vwClassList where categoryBig = #{categoryBig} and categorySmall = #{categorySmall} order by classSeq asc
	</select>
	
	
	<!-- 클래스 1개 정보 -->
	<select id="getClassDetail" parameterType="String" resultType="cddto">
		select 
		    c.*, (select min(price) from tblClassOption where classSeq = 3) as price
		from tblClass c
		    where classSeq = #{cSeq}
	</select>
	
	<!-- 해당 클래스 호스트 정보 -->
	<select id="getHost" parameterType="String" resultType="hdto">
		select * from tblHost where hostSeq = (select hostSeq from tblClass where classSeq = #{cSeq})
	</select>
	
	<!-- 특정 호스트의 총 클래스 수 -->
	<select id="getHostCount" parameterType="String" resultType="Integer">
		select count(*) from tblClass where hostSeq = #{hostSeq}
	</select>
	
	<select id="getReviewList" parameterType="String" resultType="rldto">
		select 
		    c.classSeq, cr.*
		from tblClass c
		    inner join tblClassOption co
		        on c.classSeq = co.classSeq
		    inner join tblSignupClass sc
		        on co.classOptionSeq = sc.classoptionseq
		    inner join tblClassReview cr
		        on cr.signupSeq = sc.signupseq
		            where c.classSeq = #{cSeq}
	</select>
	
	<!-- 클래스 이미지 리스트 -->
	<select id="getClassImgList" parameterType="String" resultType="cidto">
		select * from tblClassImage where classSeq = #{cSeq}
	</select>
	
	<!-- 특정 호스트의 전체 리뷰 수 -->
	<select id="getHostReviewCount" resultType="Integer" parameterType="String">
		select 
		    count(*)
		from tblClass c
		    inner join tblClassOption co
		        on c.classSeq = co.classSeq
		    inner join tblSignupClass sc
		        on co.classOptionSeq = sc.classOptionSeq
		    inner join tblClassReview cr
		        on sc.signupSeq = cr.signupSeq
		            where c.hostSeq = (select hostSeq from tblClass where classSeq = #{cSeq})
		
	</select>
	
	<!-- 특정 호스트의 스크랩 수 -->
	<select id="getHostScrapCount" resultType="Integer" parameterType="String">
		select count(*) from tblHostScrap where hostSeq = #{cSeq}
	</select>

</mapper>



















